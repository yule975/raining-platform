<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>演示登录</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .user-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .user-card:hover {
            background-color: #f8f9fa;
            border-color: #007bff;
        }
        .user-card.active {
            background-color: #e3f2fd;
            border-color: #2196f3;
        }
        .user-name {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }
        .user-role {
            color: #666;
            margin: 5px 0;
        }
        .user-email {
            color: #888;
            font-size: 14px;
        }
        .login-btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px 10px 10px 0;
            transition: background-color 0.3s;
        }
        .login-btn:hover {
            background-color: #0056b3;
        }
        .logout-btn {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px 10px 10px 0;
            transition: background-color 0.3s;
        }
        .logout-btn:hover {
            background-color: #c82333;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            font-weight: bold;
        }
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>演示用户登录</h1>
        
        <div id="status"></div>
        
        <div class="user-card" data-user="admin">
            <div class="user-name">管理员</div>
            <div class="user-role">角色: 管理员 (admin)</div>
            <div class="user-email">admin@example.com</div>
        </div>
        
        <div class="user-card" data-user="student">
            <div class="user-name">学生用户</div>
            <div class="user-role">角色: 学生 (student)</div>
            <div class="user-email">student@example.com</div>
        </div>
        
        <button class="login-btn" onclick="loginSelectedUser()">登录选中用户</button>
        <button class="logout-btn" onclick="logout()">退出登录</button>
        
        <div style="margin-top: 30px;">
            <h3>当前状态:</h3>
            <div id="currentStatus">检查中...</div>
        </div>
    </div>

    <script>
        let selectedUser = null;
        
        // 预定义的演示用户
        const demoUsers = {
            admin: {
                id: 'demo-admin-001',
                email: 'admin@example.com',
                fullName: '管理员',
                role: 'admin',
                avatarUrl: ''
            },
            student: {
                id: 'demo-student-001',
                email: 'student@example.com',
                fullName: '学生用户',
                role: 'student',
                avatarUrl: ''
            }
        };
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentStatus();
            
            // 添加用户卡片点击事件
            document.querySelectorAll('.user-card').forEach(card => {
                card.addEventListener('click', function() {
                    // 移除其他卡片的active状态
                    document.querySelectorAll('.user-card').forEach(c => c.classList.remove('active'));
                    // 添加当前卡片的active状态
                    this.classList.add('active');
                    selectedUser = this.dataset.user;
                });
            });
        });
        
        function loginSelectedUser() {
            if (!selectedUser) {
                showStatus('请先选择一个用户', 'error');
                return;
            }
            
            const user = demoUsers[selectedUser];
            
            try {
                // 设置演示用户到localStorage
                localStorage.setItem('demo_user', JSON.stringify(user));
                localStorage.setItem('user_role', user.role);
                
                // 触发自定义事件通知其他页面
                window.dispatchEvent(new CustomEvent('demo-user-login', {
                    detail: { key: 'demo_user', newValue: JSON.stringify(user) }
                }));
                
                showStatus(`已登录为: ${user.fullName} (${user.role})`, 'success');
                updateCurrentStatus();
                
                // 2秒后自动跳转到仪表板
                setTimeout(() => {
                    window.location.href = '/dashboard';
                }, 2000);
                
            } catch (error) {
                console.error('登录失败:', error);
                showStatus('登录失败: ' + error.message, 'error');
            }
        }
        
        function logout() {
            try {
                localStorage.removeItem('demo_user');
                localStorage.removeItem('user_role');
                
                // 触发自定义事件通知其他页面
                window.dispatchEvent(new CustomEvent('demo-user-login', {
                    detail: { key: 'demo_user', newValue: null }
                }));
                
                showStatus('已退出登录', 'success');
                updateCurrentStatus();
                
                // 清除选中状态
                document.querySelectorAll('.user-card').forEach(c => c.classList.remove('active'));
                selectedUser = null;
                
            } catch (error) {
                console.error('退出失败:', error);
                showStatus('退出失败: ' + error.message, 'error');
            }
        }
        
        function showStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            
            // 3秒后清除状态
            setTimeout(() => {
                statusDiv.textContent = '';
                statusDiv.className = '';
            }, 3000);
        }
        
        function updateCurrentStatus() {
            const demoUser = localStorage.getItem('demo_user');
            const userRole = localStorage.getItem('user_role');
            const statusDiv = document.getElementById('currentStatus');
            
            if (demoUser) {
                try {
                    const user = JSON.parse(demoUser);
                    statusDiv.innerHTML = `
                        <strong>已登录</strong><br>
                        用户: ${user.fullName}<br>
                        邮箱: ${user.email}<br>
                        角色: ${user.role}<br>
                        ID: ${user.id}
                    `;
                    statusDiv.style.color = '#28a745';
                } catch (error) {
                    statusDiv.textContent = '用户数据解析错误';
                    statusDiv.style.color = '#dc3545';
                }
            } else {
                statusDiv.textContent = '未登录';
                statusDiv.style.color = '#6c757d';
            }
        }
    </script>
</body>
</html>
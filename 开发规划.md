# AI训战营学习平台 - 开发规划文档

## 项目概述

本文档基于产品需求文档、API设计文档和现有前端代码，制定详细的开发规划。项目采用前后端分离架构，前端使用React+TypeScript部署在Vercel，后端使用Supabase提供数据库、认证、存储和API服务。

### 技术栈
- **前端**: React 18 + TypeScript + Vite + Tailwind CSS + shadcn/ui
- **后端**: Supabase (PostgreSQL + Auth + Storage + Edge Functions)
- **认证**: 飞书SSO + 白名单机制
- **部署**: Vercel (前端) + Supabase (后端)
- **状态管理**: TanStack Query (React Query)

---

## 第一阶段：环境搭建与基础配置 (预计3-4天)

### 1.1 Supabase项目初始化
**优先级**: 高 | **预计时间**: 0.5天

- [ ] 创建Supabase项目
- [ ] 配置项目基本设置
- [ ] 获取项目URL和API密钥
- [ ] 配置环境变量

**验收标准**: Supabase项目创建成功，可以通过API访问

### 1.2 数据库表结构设计与创建
**优先级**: 高 | **预计时间**: 1天

- [ ] 创建 `profiles` 表（用户信息）
- [ ] 创建 `authorized_users` 表（学员白名单）
- [ ] 创建 `courses` 表（课程信息）
- [ ] 创建 `course_materials` 表（课程资料）
- [ ] 创建 `assignments` 表（作业信息）
- [ ] 创建 `submissions` 表（作业提交记录）
- [ ] 设置表之间的外键关系
- [ ] 创建必要的索引

**验收标准**: 所有表创建成功，关系正确，可以进行基本的CRUD操作

### 1.3 Row Level Security (RLS) 策略配置
**优先级**: 高 | **预计时间**: 1天

- [ ] 为 `profiles` 表配置RLS策略
- [ ] 为 `authorized_users` 表配置RLS策略（仅管理员可访问）
- [ ] 为 `courses` 表配置RLS策略
- [ ] 为 `course_materials` 表配置RLS策略
- [ ] 为 `assignments` 表配置RLS策略
- [ ] 为 `submissions` 表配置RLS策略（学员只能访问自己的提交）
- [ ] 测试RLS策略的有效性

**验收标准**: RLS策略正确配置，不同角色用户只能访问授权的数据

### 1.4 飞书SSO认证配置
**优先级**: 高 | **预计时间**: 1天

- [ ] 在飞书开放平台创建应用
- [ ] 配置OAuth2.0回调地址
- [ ] 在Supabase中配置飞书认证提供商
- [ ] 创建用户注册触发器（检查白名单）
- [ ] 测试飞书SSO登录流程

**验收标准**: 飞书SSO登录正常工作，白名单验证生效

### 1.5 Supabase Storage配置
**优先级**: 中 | **预计时间**: 0.5天

- [ ] 创建 `course-materials` 存储桶
- [ ] 创建 `assignment-submissions` 存储桶
- [ ] 创建 `course-covers` 存储桶
- [ ] 配置存储桶的访问策略
- [ ] 测试文件上传和下载

**验收标准**: 存储桶创建成功，文件上传下载正常

---

## 第二阶段：后端API开发 (预计4-5天)

### 2.1 用户认证API完善
**优先级**: 高 | **预计时间**: 1天

- [ ] 完善用户注册流程（白名单验证）
- [ ] 实现获取当前用户信息API
- [ ] 实现用户角色判断逻辑
- [ ] 创建用户profile自动创建触发器
- [ ] 测试认证相关API

**验收标准**: 用户可以通过飞书SSO登录，系统正确识别用户角色

### 2.2 课程管理API开发
**优先级**: 高 | **预计时间**: 1.5天

- [ ] 实现获取课程列表API（支持分页和筛选）
- [ ] 实现获取课程详情API（包含资料和作业）
- [ ] 实现创建课程API（管理员权限）
- [ ] 实现更新课程API（管理员权限）
- [ ] 实现删除课程API（管理员权限）
- [ ] 添加课程数据验证
- [ ] 测试所有课程相关API

**验收标准**: 课程CRUD操作正常，权限控制正确

### 2.3 课程资料管理API开发
**优先级**: 高 | **预计时间**: 1天

- [ ] 实现课程资料上传API
- [ ] 实现课程资料列表获取API
- [ ] 实现课程资料下载API
- [ ] 实现课程资料删除API（管理员权限）
- [ ] 添加文件类型和大小验证
- [ ] 测试文件上传下载功能

**验收标准**: 课程资料上传下载正常，支持多种文件格式

### 2.4 作业管理API开发
**优先级**: 高 | **预计时间**: 1.5天

- [ ] 实现创建作业API（管理员权限）
- [ ] 实现获取作业列表API
- [ ] 实现获取作业详情API
- [ ] 实现作业提交API（学员权限）
- [ ] 实现作业提交更新API
- [ ] 实现获取作业提交状态API
- [ ] 实现管理员查看所有提交API
- [ ] 测试作业相关功能

**验收标准**: 作业创建、提交、查看功能正常，权限控制正确

---

## 第三阶段：前端核心功能开发 (预计6-7天)

### 3.1 认证系统前端实现
**优先级**: 高 | **预计时间**: 1.5天

- [ ] 完善登录页面UI
- [ ] 集成飞书SSO登录
- [ ] 实现用户状态管理
- [ ] 实现路由守卫
- [ ] 实现自动登录和token刷新
- [ ] 添加登录错误处理
- [ ] 测试登录登出流程

**验收标准**: 用户可以通过飞书账号登录，登录状态正确维护

### 3.2 学员界面开发
**优先级**: 高 | **预计时间**: 2天

#### 3.2.1 课程列表页面
- [ ] 实现课程卡片组件
- [ ] 集成课程列表API
- [ ] 添加课程搜索和筛选功能
- [ ] 实现响应式布局
- [ ] 添加加载状态和错误处理

#### 3.2.2 课程详情页面
- [ ] 实现视频播放器集成（飞书视频）
- [ ] 实现课程资料下载功能
- [ ] 实现作业提交界面
- [ ] 添加作业提交状态显示
- [ ] 实现文件上传组件
- [ ] 添加表单验证

**验收标准**: 学员可以浏览课程、观看视频、下载资料、提交作业

### 3.3 管理员界面开发
**优先级**: 高 | **预计时间**: 2.5天

#### 3.3.1 课程管理界面
- [ ] 实现课程列表管理页面
- [ ] 实现课程创建/编辑表单
- [ ] 集成课程封面上传功能
- [ ] 实现课程资料管理
- [ ] 添加课程删除确认
- [ ] 实现批量操作功能

#### 3.3.2 学员管理界面
- [ ] 实现学员白名单管理
- [ ] 实现单个学员添加功能
- [ ] 实现CSV批量导入功能
- [ ] 实现学员列表导出功能
- [ ] 添加学员搜索和筛选
- [ ] 实现学员删除功能

#### 3.3.3 作业管理界面
- [ ] 实现作业创建/编辑界面
- [ ] 实现作业提交状态统计
- [ ] 实现学员提交列表查看
- [ ] 实现作业提交详情查看
- [ ] 添加提交状态筛选
- [ ] 实现提交数据导出

**验收标准**: 管理员可以管理课程、学员和作业，所有管理功能正常工作

---

## 第四阶段：功能完善与优化 (预计3-4天)

### 4.1 用户体验优化
**优先级**: 中 | **预计时间**: 1天

- [ ] 添加全局加载状态指示器
- [ ] 实现Toast通知系统
- [ ] 优化表单验证提示
- [ ] 添加确认对话框
- [ ] 实现骨架屏加载效果
- [ ] 优化移动端响应式设计

**验收标准**: 用户界面友好，交互流畅，移动端适配良好

### 4.2 错误处理与异常管理
**优先级**: 中 | **预计时间**: 1天

- [ ] 实现全局错误边界
- [ ] 添加API错误统一处理
- [ ] 实现网络错误重试机制
- [ ] 添加404页面优化
- [ ] 实现错误日志记录
- [ ] 添加用户友好的错误提示

**验收标准**: 系统错误处理完善，用户体验良好

### 4.3 性能优化
**优先级**: 中 | **预计时间**: 1天

- [ ] 实现组件懒加载
- [ ] 优化图片加载（懒加载、压缩）
- [ ] 实现API数据缓存
- [ ] 优化包体积（代码分割）
- [ ] 添加预加载关键资源
- [ ] 优化首屏加载时间

**验收标准**: 页面加载速度快，用户体验流畅

### 4.4 安全性加固
**优先级**: 高 | **预计时间**: 1天

- [ ] 验证所有RLS策略
- [ ] 添加CSRF保护
- [ ] 实现文件上传安全检查
- [ ] 添加输入数据验证和清理
- [ ] 实现敏感操作二次确认
- [ ] 检查权限控制完整性

**验收标准**: 系统安全性良好，无明显安全漏洞

---

## 第五阶段：测试与部署 (预计2-3天)

### 5.1 功能测试
**优先级**: 高 | **预计时间**: 1天

- [ ] 测试用户注册登录流程
- [ ] 测试学员学习功能完整流程
- [ ] 测试管理员管理功能完整流程
- [ ] 测试文件上传下载功能
- [ ] 测试权限控制
- [ ] 测试异常情况处理

**验收标准**: 所有核心功能正常工作，无阻塞性bug

### 5.2 兼容性测试
**优先级**: 中 | **预计时间**: 0.5天

- [ ] 测试主流浏览器兼容性
- [ ] 测试移动端设备适配
- [ ] 测试不同屏幕尺寸显示
- [ ] 测试网络环境适应性

**验收标准**: 系统在主流环境下正常工作

### 5.3 部署配置
**优先级**: 高 | **预计时间**: 1天

- [ ] 配置Vercel部署环境
- [ ] 设置环境变量
- [ ] 配置自定义域名（如需要）
- [ ] 设置CI/CD流程
- [ ] 配置生产环境监控
- [ ] 准备部署文档

**验收标准**: 系统成功部署到生产环境，访问正常

### 5.4 上线准备
**优先级**: 高 | **预计时间**: 0.5天

- [ ] 准备用户使用手册
- [ ] 准备管理员操作指南
- [ ] 配置生产环境数据
- [ ] 进行最终验收测试
- [ ] 准备应急预案

**验收标准**: 系统准备就绪，可以正式上线使用

---

## 项目风险与应对措施

### 技术风险
1. **飞书SSO集成复杂性**
   - 风险：飞书API变更或集成困难
   - 应对：提前进行技术验证，准备备用认证方案

2. **Supabase服务稳定性**
   - 风险：第三方服务不稳定
   - 应对：做好数据备份，监控服务状态

3. **文件存储容量限制**
   - 风险：存储空间不足
   - 应对：监控存储使用量，制定扩容计划

### 进度风险
1. **需求变更**
   - 风险：开发过程中需求发生变化
   - 应对：及时沟通，评估影响，调整计划

2. **技术难点**
   - 风险：遇到预期外的技术难题
   - 应对：预留缓冲时间，寻求技术支持

---

## 质量保证措施

### 代码质量
- 使用TypeScript确保类型安全
- 遵循ESLint和Prettier代码规范
- 进行代码审查
- 编写必要的单元测试

### 用户体验
- 遵循无障碍设计原则
- 进行用户体验测试
- 收集用户反馈并持续改进

### 安全性
- 定期进行安全审计
- 遵循OWASP安全指南
- 实施最小权限原则

---

## 项目里程碑

| 里程碑 | 完成时间 | 主要交付物 |
|--------|----------|------------|
| M1: 环境搭建完成 | 第4天 | Supabase环境、数据库、认证配置 |
| M2: 后端API完成 | 第9天 | 完整的后端API接口 |
| M3: 前端核心功能完成 | 第16天 | 学员和管理员界面 |
| M4: 功能完善 | 第20天 | 优化后的完整系统 |
| M5: 系统上线 | 第23天 | 生产环境部署 |

---

## 总结

本开发规划将AI训战营学习平台的开发分为5个阶段，共23天的开发周期。每个阶段都有明确的目标和验收标准，确保项目按计划推进。通过合理的任务分解和风险控制，可以保证项目的顺利交付。

在开发过程中，需要密切关注用户体验和系统安全性，确保最终交付的产品稳定可靠，满足用户需求。